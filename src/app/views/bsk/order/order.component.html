<div ngbDropdown placement="bottom-end" class="d-inline-block m-1 mb-2">
  <button
    type="button"
    class="btn btn-details radius py-btns text-small"
    id="dropdownBasic1"
    ngbDropdownToggle
  >
    سفارشات {{ dropDownTitleHolder }}
  </button>
  <div
    ngbDropdownMenu
    class="mt-1 shadow-lg radius"
    aria-labelledby="dropdownBasic1"
  >
    <button
      class="text-left btn"
      ngbDropdownItem
      *ngFor="let item of statusTitles"
      (click)="getOrders(item.id, 0, filter)"
    >
      <strong>{{ item.title }}</strong>
    </button>
  </div>
</div>

<button
  (click)="openFilterModal(filterModal)"
  class="btn-filter btn d-inline-flex justify-content-around py-btns radius align-items-center m-1"
>
  <i class="i-Filter-2 text-dark text-bigger mr-2"></i>
  <strong class="text-dark ml-2 text-small"> فیلتر</strong>
</button>

<button
  class="btn-add btn d-inline-flex justify-content-around py-btns radius align-items-center add-btn"
  type="button"
  (click)="openAddModal(AddOrderModal)"
>
  <i class="i-Add text-bigger mr-2"></i><strong>ایجاد</strong>
</button>

<div
  class="flex-row d-flex justify-content-start align-items-center mb-1"
  *ngIf="filtered"
>
  <ng-container *ngFor="let filterItem of filters">
    <a
      *ngIf="filterItem.isFilled"
      class="d-inline-flex bg-light clickable-btn justify-content-start radius m-1 align-items-center"
    >
      <button
        (click)="deleteFilter(filterItem)"
        ngbTooltip="حذف فیلتر"
        [openDelay]="100"
        [closeDelay]="500"
        placement="bottom"
        class="bg-transparent btn-scale-1 btn d-flex align-items-center"
      >
        <i
          class="i-Close text-dark"
          style="font-size: 22px; font-weight: normal"
        ></i>
      </button>

      <div class="vertical"></div>
      <strong class="text-dark text-small ml-2 pt-1 pr-2"
        >{{ filterItem.label }} : {{ filterItem.title }}</strong
      >
    </a>
  </ng-container>
  <a
    (click)="deleteAllFilter()"
    class="d-inline-flex btn-delete clickable-btn justify-content-start radius m-1 align-items-center"
  >
    <button class="bg-transparent btn-scale-1 btn d-flex align-items-center">
      <i
        class="i-Close text-white"
        style="font-size: 22px; font-weight: normal"
      ></i>
    </button>
    <strong class="text-white text-small ml-2 pt-1 pr-2"
      >حذف همه فیلتر ها</strong
    >
  </a>
</div>
<section class="main-table" *ngIf="pageIsLoad">
  <table class="table">
    <thead class="bg-dark text-white">
      <tr>
        <th (click)="changeHeaderValue()" class="rounded--right text-small">
          {{ headerValue
          }}<i
            class="text-white i-Sync nav-icon m-1 float-end p-2 text-dark syncIcon"
          ></i>
        </th>
        <th class="text-small">نام کاربر</th>
        <th class="text-small"><strong>شماره حساب</strong></th>
        <th class="text-small">نام و پلن محصول</th>
        <th class="text-small">Max Balance</th>
        <th class="text-small" (click)="changeDateValue()">
          {{ dateValue
          }}<i
            class="text-white i-Sync nav-icon m-1 float-end p-2 text-dark syncIcon"
          ></i>
        </th>
        <!-- <th class="text-small" *ngIf="status == null">وضعیت</th> -->
        <th class="rounded--left text-small">جزئیات</th>
      </tr>
    </thead>
    <tbody>
      <tr
        class="p-3 shadow-sm border-bottom border-3"
        *ngFor="
          let item of rows
            | paginate
              : {
                  itemsPerPage: page.size,
                  page: page.pageNumber,
                  currentPage: page.pageNumber,
                  totalItems: page.totalElements
                }
        "
      >
        <td class="text-small" *ngIf="headerValue == 'ID'">
          {{ item.id }}
        </td>
        <td class="text-small" *ngIf="headerValue == 'کد رهگیری'">
          {{ item.code }}
        </td>
        <td class="text-small">
          {{ item.firstName }}&nbsp;{{ item.lastName }}
        </td>
        <td class="text-small">
          <strong>{{ item.accountNumber }}</strong>
        </td>
        <td class="text-small">{{ item.productTitle }}|{{ item.planTitle }}</td>
        <td class="text-small" *ngIf="item.maximumBalance != null">
          {{ item.maximumBalance }}
        </td>
        <td class="text-small" *ngIf="item.maximumBalance == null">ندارد</td>
        <td class="text-small" *ngIf="dateValue == 'تاریخ ثبت به میلادی'">
          {{ item.createDate | date : " YYYY d MMMM " }}
        </td>
        <td class="text-small" *ngIf="dateValue == ' تاریخ ثبت به شمسی'">
          {{ item.jalaliDate }}
        </td>
        <!-- <ng-container *ngIf="status == null">
          <td *ngIf="item.transactionStatus == 6">
            <span
              class="badge p-2 text-white"
              [ngClass]="item.transactionStatus == 6 ? 'wait-span' : ''"
              >{{ item.transactionStatus | transactionStatus }}</span
            >
          </td>

          <td *ngIf="item.transactionStatus == 8">
            <span
              class="badge p-2 text-white"
              [ngClass]="item.transactionStatus == 8 ? 'success-span' : ''"
              >{{ item.transactionStatus | transactionStatus }}</span
            >
          </td>

          <td *ngIf="item.transactionStatus == 1">
            <span
              class="badge p-2 text-white"
              [ngClass]="item.transactionStatus == 1 ? 'new-span' : ''"
              >{{ item.transactionStatus | transactionStatus }}</span
            >
          </td>

          <td *ngIf="item.transactionStatus == 2">
            <span
              class="badge p-2 text-white"
              [ngClass]="item.transactionStatus == 2 ? 'last-span' : ''"
              >{{ item.transactionStatus | transactionStatus }}</span
            >
          </td>

          <td
            *ngIf="
              item.transactionStatus != 2 &&
              item.transactionStatus != 1 &&
              item.transactionStatus != 6 &&
              item.transactionStatus != 8
            "
          >
            <span
              class="badge p-2 text-white"
              [ngClass]="
                item.transactionStatus != 2 &&
                item.transactionStatus != 1 &&
                item.transactionStatus != 6 &&
                item.transactionStatus != 8
                  ? 'failed-span'
                  : ''
                  ? 'new-span'
                  : ''
              "
              >{{ item.transactionStatus | transactionStatus }}</span
            >
          </td>
        </ng-container> -->

        <td class="td-oprate">
          <button
            *appCanAccess="'invoice-Full Premission'"
            class="btn-details btn d-inline-flex justify-content-around radius align-items-center"
            (click)="openDetailModal(item, openDetails)"
          >
            <i class="i-Information" style="font-size: 1.2rem"></i>
            <!-- <strong></strong> -->
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</section>

<div class="col-md-12 mt-3" *ngIf="rows?.length > 0">
  <pagination-controls
    (pageChange)="setPage($event, this.status)"
    previousLabel=""
    nextLabel=""
    responsive="true"
  ></pagination-controls>
</div>

<div *ngIf="rows?.length == 0" class="d-flex justify-content-center">
  <img
    src="../../../../../assets/images/97434-no-data-available.gif"
    class="img-fluid w-50 radius-lg"
    style="opacity: 0.4"
    alt=""
  />
</div>

<!------------------------------------------------- Delete Modal -->

<!------------------------------------------------- Details Modal -->
<ng-template #openDetails let-modal>
  <div>
    <div class="modal-header">
      <h4 class="modal-title">جزئیات و تغییر وضعیت</h4>
      <button
        type="button"
        class="close"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div class="modal-body">
      <div>
        <div class="row">
          <div class="col-12 col-lg-4 form-group mb-3">
            <strong for="totalPrice" class="mb-3">زمان ثبت سفارش</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              value="{{ orderDetail.createDate | date : 'h:mm , yyyy/M/d' }}"
              disabled
            />
          </div>
          <div class="col-6 col-lg-4 form-group mb-3">
            <strong for="totalPrice" class="mb-3">نام کاربر</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{ orderDetail.firstName }}&nbsp;{{
                orderDetail.lastName
              }}"
              disabled
            />
          </div>
          <div class="col-6 col-lg-4 form-group mb-3">
            <strong for="totalPrice" class="mb-3">شماره تماس</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{ orderDetail.phoneNumber }}"
              disabled
            />
          </div>
          <div class="col-12 col-sm-6 col-lg-4 form-group mb-3">
            <strong for="totalPrice" class="mb-3">شماره حساب</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{ orderDetail.accountNumber }}"
              disabled
            />
          </div>
          <div class="col-12 col-sm-6 col-lg-4 form-group mb-3">
            <strong for="totalPrice" class="mb-3">کد رهگیری</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{ orderDetail.code }}"
              disabled
            />
          </div>
          <div class="col-6 col-lg-4 form-group mb-3">
            <strong for="totalPrice" class="mb-3">کد معرف</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{ orderDetail.referralCode }}"
              disabled
            />
          </div>

          <div class="col-md-7 form-group mb-3">
            <strong for="totalPrice" class="mb-3">پاسخ بانک</strong>
            <textarea
              dir="ltr"
              class="form-control mt-1 text-small"
              id="totalPrice"
              rows="2"
              value="{{ orderDetail.bankResponse }}"
              disabled
            ></textarea>
          </div>
          <div class="col-md-5 form-group mb-3">
            <strong for="totalPrice" class="mb-3">توضیحات کاربر</strong>
            <textarea
              class="form-control mt-1"
              id="totalPrice"
              rows="2"
              value="{{ orderDetail.description }}"
              disabled
            ></textarea>
          </div>
          <div class="col-12 row" *ngIf="orderDetail.transactionStatus == 8">
            <div class="col-4 col-lg-3 form-group mb-3">
              <strong class="mb-3">تاریخ شروع لایسنس</strong>
              <input
                class="form-control mt-1"
                value="{{ orderDetail.startDate | date : 'yy/M/d' }}"
                disabled
              />
            </div>
            <div class="col-4 col-lg-3 form-group mb-3">
              <strong class="mb-3">تاریخ پایان لایسنس</strong>
              <input
                class="form-control mt-1"
                value="{{ orderDetail.expireDate | date : 'yy/M/d' }}"
                disabled
              />
            </div>
            <div class="col-4 col-lg-3 form-group mb-3">
              <strong class="mb-3">ورژن محصول</strong>
              <input
                class="form-control mt-1"
                value="{{ orderDetail.versionNumber }}"
                disabled
              />
            </div>
          </div>
          <div class="col-6 col-lg-3 form-group mb-3">
            <strong for="totalPrice" class="mb-3">محصول و پلن آن</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{ orderDetail.planTitle }}| {{
                orderDetail.productTitle
              }}"
              disabled
            />
          </div>
          <div class="col-6 col-lg-3 form-group mb-3">
            <strong for="totalPrice" class="mb-3">قیمت محصول</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{ orderDetail.price | currency }}"
              disabled
            />
          </div>
          <div class="col-6 col-md-3 form-group mb-3">
            <strong for="discountPrice" class="mb-3">تخفیف</strong>
            <input
              class="form-control mt-1"
              id="discountPrice"
              rows="1"
              (change)="changeFinalPrice($event.target.value)"
              value="{{ orderDetail.discountPrice | currency }}"
              disabled
            />
          </div>
          <div class="col-sm-6 col-md-3 form-group mb-3">
            <strong for="toPayPrice" class="mb-3">پرداخت نهایی</strong>
            <input
              class="form-control mt-1 bg-success text-white"
              id="toPayPrice"
              rows="1"
              value="{{ orderDetail.toPayPrice | currency }}"
              min=" {{ orderDetail.price }}"
            />
          </div>
          <div class="col-sm-6 col-md-4 form-group mb-3">
            <strong for="status" class="mb-3">وضعیت</strong>
            <input
              class="form-control mt-1 bg-success text-white"
              id="status"
              rows="1"
              value="{{ orderDetail.transactionStatus | transactionStatus }}"
              disabled
            />
          </div>

          <div class="col-md-4 form-group mb-3">
            <strong for="status" class="mb-3">تغییر وضعیت پرداخت</strong>
            <select
              class="form-control mt-1 text-dark"
              id="status"
              [ngModel]="invoiceDetail.status"
              (ngModelChange)="selectStatus($event)"
            >
              <option value="3">پرداخت شده</option>
              <option value="99">عدم پرداخت</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <ng-container
        *ngIf="
          orderDetail.transactionStatus == 2 ||
          orderDetail.transactionStatus == 8
        "
      >
        <button
          *appCanAccess="'Licence-Full Premission'"
          type="button"
          class="btn-light btn d-inline-flex justify-content-around py-btns radius align-items-center"
          (click)="openUpdateModal(sendLicense, orderDetail)"
        >
          <i class="i-File-Zip text-bigger mr-2"></i>
          <strong class="ml-2"> لایسنس</strong>
        </button>
      </ng-container>
      <button
        *appCanAccess="'note-Full Premission'"
        class="btn-light btn d-inline-flex justify-content-around py-btns radius align-items-center"
        (click)="toggleNotebar(orderDetail.id)"
      >
        <i class="i-Pen-5 text-bigger mr-2"></i>
        <strong class="ml-2 text-small">یادداشت</strong>
      </button>
      <button
        type="button"
        class="btn-save btn d-flex justify-content-around py-btns radius align-items-center"
        (click)="modal.close(true)"
      >
        <i class="i-Yes text-bigger mr-2"></i><strong>تایید</strong>
      </button>
    </div>
  </div>
</ng-template>

<!------------------------------------------------- sendLicense Modal -->

<ng-template #sendLicense let-modal>
  <div class="shadow-lg">
    <div class="modal-header">
      <h4 class="modal-title">ارسال لایسنس</h4>
      <button
        type="button"
        class="close"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="row mt-2">
        <div
          class="col-12 row d-flex flex-row align-items-center form-group mb-3"
        >
          <strong for="file" class="mb-3 ml-2">فایل لایسنس</strong>
          <ng-container *ngIf="licenseModel.fileExists">
            <div class="col-md-2 col-5 mb-5 mt-1">
              <img
                class="align-self-center w-100 radius-md"
                src="assets/images/zip-file-icon.png"
              />
            </div>
            <div class="col-md-6 col-5">
              <a
                class="btn-download btn d-inline-flex justify-content-around py-btns radius align-items-center m-1"
                href="https://dl.iraniExpert.com/{{ licenseModel.filePath }}"
                ><i class="i-Download text-dark text-bigger mr-3"></i>
                <strong>دانلود</strong></a
              >
              <button
                class="btn-delete btn d-inline-flex justify-content-around py-btns radius align-items-center"
                (click)="deleteModal(licenseModel, deletingModal, 1)"
              >
                <i class="i-Close text-bigger mr-2"></i>
                <strong> حذف</strong>
              </button>
            </div>
          </ng-container>
          <input
            id="upload"
            type="file"
            *ngIf="!licenseModel.fileExists"
            (change)="onFileChanged($event)"
          />
        </div>
        <ng-container *ngIf="!licenseModel.fileExists">
          <strong class="text-danger col-12">فایل ارسالی باید zip باشد</strong>
          <div class="col-12 mt-2 mb-2">
            <button
              class="btn-upload btn d-inline-flex justify-content-around py-btns radius align-items-center"
              (click)="uploadFile()"
              [disabled]="!isValidate"
            >
              <i class="i-Upload text-dark text-bigger mr-3"></i>
              <strong>آپلود</strong>
            </button>
          </div>
        </ng-container>
        <div class="col-md-5 form-group mb-3" dir="ltr">
          <strong for="startDate" class="mb-3">تاریخ شروع</strong>
          <input
            (click)="s.toggle()"
            type="text"
            class="form-control"
            ngbDatepicker
            #s="ngbDatepicker"
            [(ngModel)]="startDate"
          />
        </div>
        <div class="col-md-5 form-group mb-3" dir="ltr">
          <strong for="expireDate" class="mb-3">تاریخ انقضا</strong>
          <input
            (click)="e.toggle()"
            type="text"
            class="form-control"
            ngbDatepicker
            #e="ngbDatepicker"
            [(ngModel)]="expireDate"
          />
        </div>
        <div class="col-md-5 form-group mb-3" dir="ltr">
          <strong for="versionNumber" class="mb-3">Version Number</strong>
          <input type="text" class="form-control" [(ngModel)]="versionNumber" />
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button
        type="button"
        class="btn-upload btn d-inline-flex justify-content-around py-btns radius align-items-center"
        (click)="modal.close(true)"
      >
        <i class="i-Upload text-dark text-bigger mr-3"></i>
        <strong>ارسال</strong>
      </button>
    </div>
  </div>
</ng-template>

<!-- Note Model -->

<div
  [ngClass]="{ open: _orderService.sidebarState.sidenavOpen }"
  class="notebar-left rtl-ps-none bg-lightdark shadow-lg my-webKit"
  style="overflow-y: auto"
>
  <div class="mt-3 ml-3 mb-3">
    <i
      (click)="clearNote()"
      (click)="updateNotebar()"
      ngbTooltip="بستن"
      [openDelay]="100"
      [closeDelay]="500"
      placement="bottom"
      class="i-Close bg-dark text-white border-0 clickable-btn rounded-circle"
    ></i>
  </div>
  <hr class="separator-breadcrumb mt-0 mb-1" />
  <div class="ml-3">
    <form action="">
      <div class="row g-0 p-0 m-0">
        <div class="col-lg-12 col-md-11 col-10 form-group mb-3 mt-3">
          <label class="text-white" for="title">ایجاد یادداشت</label>
          <textarea
            name="title"
            id="title"
            type="text"
            [(ngModel)]="note.text"
            class="form-control bg-white text-dark textarea-font"
          ></textarea>
        </div>
      </div>
    </form>
    <div class="d-flex justify-content-end mr-3">
      <button
        [disabled]="
          note.text == '' ||
          note.text == ' ' ||
          note.text == '  ' ||
          note.text == '   ' ||
          note.text == '    '
        "
        type="button"
        class="btn-add btn d-inline-flex justify-content-around py-btns radius align-items-center mb-2"
        (click)="openConfirmationModal(note, confirmationModal)"
      >
        <i class="i-Add text-bigger mr-2"></i
        ><strong class="text-smaller">ایجاد</strong>
      </button>
    </div>
  </div>
  <hr class="separator-breadcrumb mt-2 mb-1" />
  <div class="p-2"><h4 class="pl-2 text-light text-small">یادداشت ها</h4></div>
  <ul class="aside-left">
    <li class="aside-item lvl1">
      <div class="aside-item-hold">
        <div class="my-css">
          <div>
            <ng-container *ngFor="let item of notes">
              <div
                class="timeline-card rounded-4 bg-notes shadow-lg card mt-2"
                *ngIf="toggled == true"
              >
                <div class="rounded-alt bg-notes-header m-0 p-0">
                  <div class="d-flex justify-content-between">
                    <p class="m-0 p-2">{{ item.name }}</p>
                  </div>
                </div>
                <div class="card-body">
                  <b class="text-black">
                    {{ item.text }}
                  </b>
                </div>
                <div class="text-black mt-2 p-2 pb-0">
                  <smaller class="m-1"
                    >{{
                      item.createDate | date : "  h:mm , yyyy/M/d "
                    }},</smaller
                  >
                  <smaller class="m-1">{{ item.jalaliDate }}</smaller>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
      </div>
    </li>
  </ul>
</div>

<!-- Add Modal -->
<ng-template #confirmationModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-title">ایجاد</h4>
    <button
      ngbAutofocus
      type="button"
      class="close"
      aria-label="Close button"
      aria-describedby="modal-title"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <p><strong>آیا از ایجاد این یادداشت مطمئنید؟</strong></p>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn-delete btn d-inline-flex justify-content-around py-btns radius align-items-center ml-2"
      (click)="modal.dismiss('cancel')"
    >
      <i class="i-Close text-bigger mr-2"></i><strong>خیر</strong>
    </button>
    <button
      type="button"
      class="btn-save btn d-inline-flex justify-content-around py-btns radius align-items-center"
      (click)="modal.close(true)"
    >
      <i class="i-Yes text-bigger mr-2"></i><strong>بله</strong>
    </button>
  </div>
</ng-template>

<ng-template #deletingModal let-modal>
  <div class="shadow-lg">
    <div class="modal-header">
      <h4 class="modal-title" id="modal-title">حذف</h4>
      <button
        type="button"
        class="close"
        aria-label="Close button"
        aria-describedby="modal-title"
        (click)="modal.dismiss('Cross click')"
      >
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <p><strong>آیا از حذف مطمئنید؟</strong></p>
    </div>
    <div class="modal-footer">
      <button
        type="button"
        class="btn-save btn d-inline-flex justify-content-around py-btns radius align-items-center"
        (click)="modal.dismiss('cancel')"
      >
        <i class="i-Close text-bigger mr-2"></i><strong>خیر</strong>
      </button>
      <button
        type="button"
        ngbAutofocus
        class="btn-delete btn d-inline-flex justify-content-around py-btns radius align-items-center ml-2"
        (click)="modal.close('Ok')"
      >
        <i class="i-Yes text-bigger mr-2"></i><strong>بله</strong>
      </button>
    </div>
  </div>
</ng-template>
<ng-template #filterModal let-modal>
  <div class="d-flex align-items-center bg--gray">
    <div class="col-11 container mt-2 mb-2 contrast">
      <div class="modal-header row">
        <h4 class="modal-title text-white" id="modal-basic-title">فیلتر</h4>

        <button
          type="button"
          class="close text-white"
          aria-label="Close"
          (click)="modal.dismiss()"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form class="row" [formGroup]="filterForm" (ngSubmit)="modal.close(true)">
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label class="text-white">ID</label>
              <input
                class="form-control"
                [(ngModel)]="filterModel.iD"
                formControlName="iD"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label class="text-white">ایدی کاربری</label>
              <input
                class="form-control"
                [(ngModel)]="filterModel.userID"
                formControlName="userID"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label class="text-white">نام</label>
              <input
                class="form-control"
                [(ngModel)]="filterModel.firstName"
                formControlName="firstName"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label class="text-white">نام خانوادگی</label>
              <input
                class="form-control"
                [(ngModel)]="filterModel.lastName"
                formControlName="lastName"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label class="text-white">شماره حساب</label>
              <input
                class="form-control"
                [(ngModel)]="filterModel.accountNumber"
                formControlName="accountNumber"
              />
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              *ngIf="status == 8"
            >
              <label class="text-white">نسخه لایسنس</label>
              <input
                name="accountNumber"
                id="accountNumber"
                class="form-control"
                [(ngModel)]="filterModel.versionNumber"
                formControlName="versionNumber"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3" dir="ltr">
              <label for="accountNumber " class="text-white"> ت ثبت از</label>

              <input
                (click)="d.toggle()"
                type="text"
                class="form-control"
                ngbDatepicker
                #d="ngbDatepicker"
                [(ngModel)]="FCrtDate"
                formControlName="fromCreateDate"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3" dir="ltr">
              <label class="text-white">ت ثبت تا</label>

              <input
                (click)="e.toggle()"
                type="text"
                class="form-control"
                ngbDatepicker
                #e="ngbDatepicker"
                [(ngModel)]="TCrtDate"
                formControlName="ToCreateDate"
              />
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              dir="ltr"
              *ngIf="status == 8"
            >
              <label class="text-white">ت شروع لایسنس</label>

              <input
                (click)="m.toggle()"
                type="text"
                class="form-control"
                ngbDatepicker
                #m="ngbDatepicker"
                [(ngModel)]="FStrDate"
                formControlName="fromStartDate"
              />
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              dir="ltr"
              *ngIf="status == 8"
            >
              <label class="text-white">ت شروع لایسنس تا</label>

              <input
                (click)="s.toggle()"
                type="text"
                class="form-control"
                ngbDatepicker
                #s="ngbDatepicker"
                [(ngModel)]="TStrDate"
                formControlName="toStartDate"
              />
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              dir="ltr"
              *ngIf="status == 8"
            >
              <label for="accountNumber " class="text-white"
                >ت پایان لایسنس از</label
              >

              <input
                (click)="fe.toggle()"
                type="text"
                class="form-control"
                ngbDatepicker
                #fe="ngbDatepicker"
                [(ngModel)]="FExpDate"
                formControlName="fromExpireDate"
              />
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              dir="ltr"
              *ngIf="status == 8"
            >
              <label class="text-white">ت پایان لایسنس تا</label>

              <input
                (click)="ms.toggle()"
                type="text"
                class="form-control"
                ngbDatepicker
                #ms="ngbDatepicker"
                [(ngModel)]="TExpDate"
                formControlName="toExpireDate"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label class="text-white">محصول</label>
              <select
                class="form-control mt-1 text-dark"
                [(ngModel)]="filterModel.productID"
                (ngModelChange)="selectProduct($event)"
                formControlName="productID"
              >
                <option
                  *ngFor="let item of productModel.items"
                  value="{{ item.id }}"
                >
                  {{ item.title }}
                </option>
              </select>
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label class="text-white">پلن محصول</label>
              <select
                formControlName="planID"
                class="form-control mt-1 text-dark"
                [(ngModel)]="filterModel.planID"
                (ngModelChange)="selectProductPlan($event)"
              >
                <ng-container *ngFor="let item of plans">
                  <option *ngIf="plans.length !== 0" value="{{ item.id }}">
                    <p class="text-small">
                      {{ item.title }}
                    </p>
                  </option>
                </ng-container>
                <option *ngIf="plans.length == 0">
                  <p class="text-small">لطفا اول محصول را انتخاب کنید</p>
                </option>
              </select>
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label class="text-white">کد</label>
              <input
                class="form-control"
                [(ngModel)]="filterModel.code"
                formControlName="code"
              />
            </div>

            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3" dir="ltr">
              <label class="text-white">شماره تماس</label>
              <input
                class="form-control"
                [(ngModel)]="filterModel.phoneNumber"
                formControlName="phoneNumber"
              />
            </div>

            <!-- <div class="col-md-6 form-group mb-3 mt-3">
              <label for="accountNumber " class="text-white">امتیاز</label>
              <select
              class="form-control  text-dark"
              id="status"
              [(ngModel)]="filterModel.rate"
              [formControl]="filterForm.controls['rate']"
            >
              <option value=1>1</option>
              <option value=2>2</option>
              <option value=3>3</option>
              <option value=4>4</option>
              <option value=5>5</option>
            </select>
            </div> -->
          </div>
        </div>
        <div class="modal-footer w-100">
          <button
            ngbAutofocus
            type="button"
            class="btn-light btn d-inline-flex justify-content-around py-btns radius align-items-center ml-2"
            (click)="modal.close(true)"
          >
            <i class="i-Yes text-bigger mr-2"></i>
            <strong class="ml-2 text-small">تائید</strong>
          </button>

          <button
            type="button"
            class="btn-delete btn d-flex justify-content-around py-btns radius align-items-center"
            (click)="modal.dismiss()"
          >
            <i class="i-Close text-bigger mr-2"></i><strong>انصراف</strong>
          </button>
        </div>
      </form>
    </div>
  </div>
</ng-template>
<ng-template #AddOrderModal let-modal>
  <div class="d-flex align-items-center">
    <div class="col-11 container mt-2 mb-2 contrast">
      <div class="modal-header row">
        <h4 class="modal-title" id="modal-basic-title">
          ثبت سفارش <small>{{ addOrderModalTable }}</small>
        </h4>

        <button
          type="button"
          class="close text-white"
          aria-label="Close"
          (click)="modal.dismiss()"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="row justify-content-start align-items-center">
        <button
          href="#"
          class="button pulse p-2 m-2"
          (click)="changeAddTypeofRequest()"
        >
          <i class="i-Add-User icon-font-size" *ngIf="AddorderSituation"></i>
          <i class="i-Bag-Items icon-font-size" *ngIf="!AddorderSituation"></i>
        </button>
        <div *ngIf="AddorderSituation">افزودن کاربر</div>
        <div *ngIf="!AddorderSituation">ثبت سفارش با ایدی کاربر</div>
      </div>

      <form
        class="row"
        [formGroup]="AddOrderForm"
        (ngSubmit)="modal.close(true)"
      >
        <div class="modal-body">
          <div class="row">
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              *ngIf="AddorderSituation"
            >
              <label>شناسه کاربر</label>
              <input
                class="form-control"
                [(ngModel)]="AddOrderModel.userID"
                [formControl]="AddOrderForm.controls['userId']"
                (focusout)="getUserbyUserId()"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label>شماره حساب</label>
              <input
                class="form-control"
                [formControl]="AddOrderForm.controls['accountNumber']"
                [(ngModel)]="AddOrderModel.accountNumber"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label>(Tx Id) کد پرداخت </label>
              <input
                class="form-control"
                [(ngModel)]="AddOrderModel.transactionCode"
                [formControl]="AddOrderForm.controls['transactionCode']"
              />
            </div>

            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              *ngIf="(userInfo | json) != ({} | json) && AddorderSituation"
            >
              <label>نام و نام خانوادگی</label>
              <div class="card-purple shadow-sm">
                <div class="p-1">
                  <div class="text-white text-center p-1 card-text-font">
                    {{ AddOrderModel.firstName }} {{ AddOrderModel.lastName }}
                  </div>
                </div>
              </div>
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              *ngIf="(userInfo | json) != ({} | json) && AddorderSituation"
            >
              <label>شماره تماس</label>
              <div class="card-purple shadow-sm">
                <div class="p-1">
                  <div class="text-white text-center p-1 card-text-font">
                    {{ AddOrderModel.phoneNumber }}
                  </div>
                </div>
              </div>
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              *ngIf="(userInfo | json) != ({} | json) && AddorderSituation"
            >
              <label>ایمیل</label>
              <div class="card-purple shadow-sm">
                <div class="p-1">
                  <div class="text-white text-center p-1 card-text-font">
                    {{ AddOrderModel.email }}
                  </div>
                </div>
              </div>
            </div>

            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              *ngIf="!AddorderSituation"
            >
              <label>نام</label>
              <input
                class="form-control"
                [(ngModel)]="AddOrderModel.firstName"
                [formControl]="AddOrderForm.controls['firstName']"
              />
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              *ngIf="!AddorderSituation"
            >
              <label>نام خانوادگی</label>
              <input
                class="form-control"
                [(ngModel)]="AddOrderModel.lastName"
                [formControl]="AddOrderForm.controls['lastName']"
              />
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              *ngIf="!AddorderSituation"
            >
              <label>ایمیل</label>
              <input
                class="form-control"
                [(ngModel)]="AddOrderModel.email"
                [formControl]="AddOrderForm.controls['email']"
                placeholder="you@example.com"
              />
              <div
                class="text--primary text--smaller text-danger"
                *ngIf="
                  AddOrderForm.controls['email'].invalid &&
                  AddOrderForm.controls['email'].dirty
                "
              >
                فیلد ایمیل صحیح نیست
              </div>
            </div>
            <div
              class="col-md-6 col-lg-4 form-group mb-3 mt-3"
              *ngIf="!AddorderSituation"
            >
              <label>شماره تماس</label>
              <input
                class="form-control"
                [(ngModel)]="AddOrderModel.phoneNumber"
                [formControl]="AddOrderForm.controls['phoneNumber']"
              />
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label>محصول</label>
              <select
                class="form-control mt-1 text-dark"
                [formControl]="AddOrderForm.controls['productID']"
                [(ngModel)]="AddOrderModel.productID"
                (ngModelChange)="addSelectProduct($event)"
              >
                <option
                  *ngFor="let item of AddproductModel.items"
                  value="{{ item.id }}"
                >
                  {{ item.title }}
                </option>
              </select>
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label>پلن</label>
              <select
                class="form-control mt-1 text-dark"
                [formControl]="AddOrderForm.controls['planID']"
                [(ngModel)]="AddOrderModel.planID"
                (ngModelChange)="addSelectPlan($event)"
              >
                <option *ngIf="addPlans.length == 0">
                  <p class="text-small">لطفا اول محصول را انتخاب کنید</p>
                </option>
                <option *ngFor="let item of addPlans" value="{{ item.id }}">
                  {{ item.title }}
                </option>
              </select>
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label>مبلغ کل</label>
              <div class="p-1">
                {{ AddOrderModel.price }}
              </div>
            </div>
            <div class="col-md-6 col-lg-4 form-group mb-3 mt-3">
              <label>مبلغ تخفیف</label>
              <input
                class="form-control"
                [formControl]="AddOrderForm.controls['discountPrice']"
                [(ngModel)]="AddOrderModel.discountPrice"
              />
            </div>

            <div class="col-md-4 col-lg-3 form-group mb-3 mt-3">
              <label>مبلغ پرداختی</label>
              <div class="card-green shadow-lg">
                <div class="p-1">
                  <a
                    class="btn p-1"
                    *ngIf="
                      AddOrderModel.discountPrice < AddOrderModel.price ||
                      AddOrderModel.price == null
                    "
                    ><i
                      class="i-Dollar-Sign-2 btn-blue-right-section m-0 p-1 d-grid text-white"
                    ></i
                  ></a>
                  <a
                    class="btn p-1 text-white"
                    *ngIf="AddOrderModel.price != null"
                    >{{
                      AddOrderModel.discountPrice > AddOrderModel.price
                        ? "مبلغ صحیح نیست"
                        : AddOrderModel.price - AddOrderModel.discountPrice
                    }}</a
                  >
                </div>
              </div>
            </div>
            <!-- <div class=" col-12 form-group mb-3 mt-3">
            <label >توضیحات</label>
            <textarea
            cols="30"
            rows="4"
            type="text"
            class="form-control"
            formControlName="description"
            [(ngModel)]="AddOrderModel.description"
            maxlength="500"></textarea>
          </div> -->
          </div>
          <div class="modal-footer w-100">
            <button
              type="button"
              class="btn-delete btn d-flex justify-content-around py-btns radius align-items-center"
              (click)="modal.dismiss()"
            >
              <i class="i-Close text-bigger mr-2"></i><strong>انصراف</strong>
            </button>
            <button
              ngbAutofocus
              type="button"
              class="btn-light btn d-inline-flex justify-content-around py-btns radius align-items-center ml-2"
              (click)="modal.close(true)"
              [disabled]="
                !AddOrderForm.valid ||
                AddOrderModel.price <= AddOrderModel.discountPrice
              "
            >
              <i class="i-Yes text-bigger mr-2"></i>
              <strong class="ml-2 text-small">تائید</strong>
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</ng-template>
