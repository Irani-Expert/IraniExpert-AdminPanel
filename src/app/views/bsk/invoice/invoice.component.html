<!----------------------------------- Head Table  -->
<div class="row list-horizontal">
  <div
    class="list-item"
    [ngClass]="{
      'col-md-12': viewMode === 'list',
      'col-md-3': viewMode === 'grid'
    }"
  >
    <div
      class="card bg-dark mb-4 d-flex"
      [ngClass]="{
        'flex-row': viewMode === 'list',
        'flex-column': viewMode === 'grid'
      }"
    >
      <div
        class="flex-grow-1"
        [ngClass]="{
          'pl-2 d-flex': viewMode === 'list',
          'd-block': viewMode === 'grid'
        }"
      >
        <!-- <div class="list-thumb">
               THUMBNAIL
            </div> -->
        <!-- ID -->
        <div class="align-self-center text-white">ID</div>
        <div
          class="card-body align-self-center d-flex align-items-lg-center text-center"
          [ngClass]="{ 'flex-lg-row': viewMode === 'list' }"
        >
          <!-- OTHER DATA -->
          <div class="col text-lg-center w-25  text-white">زمان پاسخ بانک</div>
          <div class="col text-lg-center w-25  text-white">
            پاسخ بانک
          </div>
          <div class="col text-lg-center w-25  text-white">
            قیمت نهایی
          </div>
          <div class="col text-lg-center w-25  text-white">وضعیت</div>
          <div
            class="text-light d-md-block d-none col text-center w-25 "
          >
            عملیات
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Orders-List -->
  <div
    class="list-item"
    [ngClass]="{
      'col-md-12': viewMode === 'list',
      'col-md-3': viewMode === 'grid'
    }"
    *ngFor="let item of rows"
  >
    <div
      class="card mb-2 o-hidden d-flex"
      [ngClass]="{
        'flex-row-2': viewMode === 'list',
        'flex-column': viewMode === 'grid'
      }"
    >
      <div
        class="flex-grow-1"
        [ngClass]="{
          'pl-2 d-flex': viewMode === 'list',
          'd-block': viewMode === 'grid'
        }"
      >
        <!-- <div class="list-thumb">
                 THUMBNAIL
              </div> -->
        <!-- ID -->
        <div class="align-self-center">{{ item.id }}</div>
        <div
          class="card-body align-self-center d-flex align-items-lg-center text-center row"
          [ngClass]="{ 'flex-lg-row': viewMode === 'list' }"
        >
          <!-- OTHER DATA -->
          <div class="col m-0 ">
            {{ item.bankResponseDate | relativeTime }}
          </div>
          <div class="col m-0 brief-text">
            {{ item.bankResponse }}
          </div>
          <div class="col m-0">
            {{ item.toPayPrice | currency }}
          </div>
          <div class="col m-0">
            {{ item.status|paymentStatus }}
          </div>
          <div
            class="col d-sm-none d-none d-md-inline-block d-lg-inline-block d-xl-inline-block"
          >
            <div class="text-center col-auto d-flex justify-content-around">
              <div class="w-25  mr-sm-2">
                <button
                  class="btn btn-info"
                  [ngClass]="{ 'd-none': viewMode === 'grid' }"
                  (click)="openModal(openDetails,item)"
                >
                جزئیات
                </button>
              </div>
              <div class="w-25  ml-sm-2">
                <button
                  class="btn btn-danger"
                  [ngClass]="{ 'd-none': viewMode === 'grid' }"
                >
                  حذف
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div
        class="text-center row m-5 d-sm-block d-block d-md-none d-lg-none d-xl-none"
      >
        <h6 class="text-center">عملیات</h6>
        <button
          type="button"
          [ngClass]="{ 'd-none': viewMode === 'grid' }"
          class="btn btn-outline-danger col m-1"
        >
          حذف
        </button>
        <button
          type="button"
          [ngClass]="{ 'd-none': viewMode === 'grid' }"
          class="btn btn-outline-info col m-1"
          (click)="openModal(openDetails,item)"
        >
        جزئیات
        </button>
      </div>
    </div>
  </div>
</div>
<!----------------Details Modal -->
<ng-template #openDetails let-modal>
  <div>
    <div class="modal-header" >
      <h4 class="modal-title">
         جزئیات و تغییر وضعیت
      </h4>
      <button
        type="button"
        class="close"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <form  [formGroup]="addForm" (ngSubmit)="submit()">
    <div class="modal-body">
     
        <div class="row">
          <div class="col col-md-3 form-group mb-3">
            <label for="createDate">ایجاد شده در:</label>
            <div 
            for="createDate" 
            class="mb-3 text-white rounded-left rounded-right bg-dark p-2">
            {{invoiceDetail.createDate | date: " d MMMM "}}
            </div>    
          </div>
          <div class="col col-md-3 form-group mb-3">
            <label for="updateDate">آخرین به روزرسانی:</label>
            <div 
            for="updateDate" 
            class="mb-3 text-white rounded-left rounded-right bg-dark p-2">
            {{invoiceDetail.updateDate | relativeTime}}
            </div>    
          </div>
          <div class="col-md-8 form-group mb-3">
            <strong for="bankResponse" class="mb-3">پاسخ بانک</strong>
            <textarea
              class="form-control mt-1"
              id="bankResponse"
              rows="1"
              value="{{invoiceDetail.bankResponse}}"
              disabled
            >
            </textarea>
          </div>
          <div class="col-md-4 form-group mb-3 align-self-md-end">
            <strong for="bankResponseDate">زمان پاسخ بانک :{{invoiceDetail.bankResponseDate | relativeTime}}</strong>
          </div>
          <div class="col-md-3 form-group mb-3">
            <strong for="totalPrice" class="mb-3">قیمت محصول</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{invoiceDetail.totalPrice |currency}}"
              disabled
            />
            
          </div>
          <div class="col-md-3 form-group mb-3">
            <strong for="discountPrice" class="mb-3">تخفیف اعمال شده</strong>
            <input
              class="form-control mt-1"
              id="discountPrice"
              rows="1"
              value="{{invoiceDetail.discountPrice|currency}}"
              disabled
            />
            
          </div>
          <div class="col-md-3 form-group mb-3">
            <strong for="toPayPrice" class="mb-3">قیمت نهایی برای پرداخت</strong>
            <input
              class="form-control mt-1 bg-success text-white"
              id="toPayPrice"
              rows="1"
              value="{{invoiceDetail.toPayPrice|currency}}"
              disabled
            />
            
          </div>
          <div class="col-md-4 form-group mb-3">
            <strong for="status" class="mb-3">وضعیت</strong>
            <select
              class="form-control mt-1 text-dark"
              id="status"
              placeholder="{{invoiceDetail.status|paymentStatus}}"
              [formControl]="addForm.controls['status']"
              [ngModel]="invoiceDetail.status"
              (ngModelChange)="selectStatus($event)"
            >
            <option value="0">شروع سفارش</option>
            <option value="1">'آماده سفارش</option>
            <option value="2">درانتظار پرداخت</option>
            <option value="3">پرداخت شده</option>
            <option value="4">در انتظار تائید</option>
            <option value="98">خطا در اعتبار سنجی</option>
            <option value="99">با خطا مواجه شده</option>
          </select>
          </div>
         
          <!-- <div class="col-md-3 form-group mb-3">
            <strong for="bankType" class="mb-3">نوع بانک</strong>
            <input
              class="form-control mt-1 bg-success text-white"
              id="bankType"
              rows="1"
              value="{{invoiceDetail.bankType|bankType}}"
              disabled
            />
            
          </div> -->
          <!-- <div class="col-md-3 form-group mb-3">
            <strong for="backMethodType" class="mb-3">قیمت نهایی برای پرداخت</strong>
            <input
              class="form-control mt-1 bg-success text-white"
              id="backMethodType"
              rows="1"
              value="{{invoiceDetail.backMethodType|bankMethod}}"
              disabled
            />
            
          </div> -->
          <!-- [ngClass]="{ 
            'bg-primary': invoiceDetail.status === 0 ,
            'bg-light text-dark': invoiceDetail.status === 1 ,
            'bg-info': invoiceDetail.status === 2 ,
            'bg-success': invoiceDetail.status === 3 ,
            'bg-info': invoiceDetail.status === 4 ,
            'bg-warning text-dark': invoiceDetail.status === 98 ,
            'bg-danger': invoiceDetail.status === 99 }" -->
            <!-- isConfirmed -->
        <div class="form-group col-auto mb-3 mt-3 text-center">
          <label class="m-2">تائید</label>
          <label class="switch switch-primary mr-2 m-2">
            <input
              [(ngModel)]="invoiceDetail.isConfirmed"
              [formControl]="addForm.controls['isConfirmed']"
              type="checkbox"
              id="isConfirmed"
            />
            <span class="slider"></span>
          </label>
          <label>عدم تائید</label>
        </div>
          
        </div>
      
    </div>
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-outline-dark btn-rounded"
        (click)="addOrUpdate(invoiceDetail)"
      >
        ویرایش
      </button>
    </div>
  </form>
  </div>
</ng-template>