<!----------------------------------- Head Table  -->
<div class="row list-horizontal">
  <div
    class="list-item"
    [ngClass]="{
      'col-md-12': viewMode === 'list',
      'col-md-3': viewMode === 'grid'
    }"
  >
    <div
      class="card bg-dark mb-4 d-flex"
      [ngClass]="{
        'flex-row': viewMode === 'list',
        'flex-column': viewMode === 'grid'
      }"
    >
      <div
        class="flex-grow-1"
        [ngClass]="{
          'pl-2 d-flex': viewMode === 'list',
          'd-block': viewMode === 'grid'
        }"
      >
        <!-- <div class="list-thumb">
               THUMBNAIL
            </div> -->
        <!-- ID -->
        <div class="align-self-center text-white">ID</div>
        <div
          class="card-body align-self-center d-flex align-items-lg-center text-center"
          [ngClass]="{ 'flex-lg-row': viewMode === 'list' }"
        >
          <!-- OTHER DATA -->
          <div class="col text-lg-center w-25 text-white">
            زمان ایجاد فاکتور
          </div>
          <div class="col text-lg-center w-25 text-white">پاسخ بانک</div>
          <div class="col text-lg-center w-25 text-white">قیمت نهایی</div>
          <div class="col text-lg-center w-25 text-white">وضعیت</div>
          <div class="text-light d-md-block d-none col text-center w-25">
            عملیات
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Invoice - List -->
  <div
    class="list-item"
    [ngClass]="{
      'col-md-12': viewMode === 'list',
      'col-md-3': viewMode === 'grid'
    }"
    *ngFor="
      let item of rows
        | paginate
          : {
              itemsPerPage: page.size,
              page: page.pageNumber,
              currentPage: page.pageNumber,
              totalItems: page.totalElements
            }
    "
  >
    <div
      class="card mb-2 o-hidden d-flex"
      [ngClass]="{
        'flex-row-2': viewMode === 'list',
        'flex-column': viewMode === 'grid'
      }"
    >
      <div
        class="flex-grow-1"
        [ngClass]="{
          'pl-2 d-flex': viewMode === 'list',
          'd-block': viewMode === 'grid'
        }"
      >
        <!-- <div class="list-thumb">
                 THUMBNAIL
              </div> -->
        <!-- ID -->
        <div class="align-self-center">{{ item.id }}</div>
        <div
          class="card-body align-self-center d-flex align-items-lg-center text-center row"
          [ngClass]="{ 'flex-lg-row': viewMode === 'list' }"
        >
          <!-- OTHER DATA -->
          <div class="col m-0">
            {{ item.createDate | relativeTime }}
          </div>
          <div class="col m-0 brief-text">
            {{ item.bankResponse }}
          </div>
          <div class="col m-0">
            {{ item.toPayPrice | currency }}
          </div>
          <div class="col m-0">
            {{ item.status | paymentStatus }}
          </div>
          <div
            class="col d-sm-none d-none d-md-inline-block d-lg-inline-block d-xl-inline-block"
          >
            <div class="text-center col-auto d-flex justify-content-around">
              <div class="w-25 mr-sm-2">
                <button
                  *appCanAccess="'invoice-Watch'"
                  class="btn btn-info"
                  [ngClass]="{ 'd-none': viewMode === 'grid' }"
                  (click)="openModal(openDetails, item)"
                >
                  جزئیات
                </button>
              </div>
              <div class="w-25 ml-sm-2">
                <button
                  *appCanAccess="'invoice-Delete'"
                  class="btn btn-danger"
                  [ngClass]="{ 'd-none': viewMode === 'grid' }"
                >
                  حذف
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div
        class="text-center row m-5 d-sm-block d-block d-md-none d-lg-none d-xl-none"
      >
        <h6 class="text-center">عملیات</h6>
        <button
          type="button"
          [ngClass]="{ 'd-none': viewMode === 'grid' }"
          class="btn btn-outline-danger col m-1"
        >
          حذف
        </button>
        <button
          type="button"
          [ngClass]="{ 'd-none': viewMode === 'grid' }"
          class="btn btn-outline-info col m-1"
          (click)="openModal(openDetails, item)"
        >
          جزئیات
        </button>
      </div>
    </div>
  </div>
  <div class="col-md-12 mt-3" *ngIf="rows?.length > 0">
    <pagination-controls
      (pageChange)="setPage($event)"
      previousLabel=""
      nextLabel=""
    ></pagination-controls>
  </div>
</div>
<div *ngIf="rows?.length == 0" class="d-flex justify-content-center">
  <img
    src="../../../../../assets/images/97434-no-data-available.gif"
    class="img-fluid w-50"
    alt=""
  />
</div>
<!----------------Details Modal -->
<ng-template #openDetails let-modal>
  <div>
    <div class="modal-header">
      <h4 class="modal-title">جزئیات و تغییر وضعیت</h4>
      <button
        type="button"
        class="close"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div class="modal-body">
      <form [formGroup]="addForm" (ngSubmit)="submit()">
        <div class="row">
          <div class="col col-md-4 form-group mb-3">
            <label for="createDate">تاریخ ثبت فاکتور:</label>
            <div
              for="createDate"
              class="mb-3 text-white rounded-left rounded-right bg-dark p-2"
            >
              {{ invoiceDetail.createDate | date : " d MMMM " }}
            </div>
          </div>
          <div class="col col-md-4 form-group mb-3">
            <label for="updateDate">آخرین به روزرسانی:</label>
            <div
              for="updateDate"
              class="mb-3 text-white rounded-left rounded-right bg-dark p-2"
            >
              {{ invoiceDetail.updateDate | relativeTime }}
            </div>
            <!-- <div class="col col-md-5 form-group mb-3">
              <label for="Name">نام و نام خانوادگی</label>
              <div
              for="Name"
              class="mb-3 text-white rounded-left rounded-right bg-dark p-2">
              {{invoiceDetail.userInfo.firstName }}&nbsp;{{invoiceDetail.userInfo.firstName }}
              </div>
            </div>
            <div class="col col-md-5 form-group mb-3">
            <label for="phoneNumber">شماره</label>
            <div
            for="phoneNumber"
            class="mb-3 text-white rounded-left rounded-right bg-dark p-2">
            {{orderModel.userInfo.phoneNumber }}
            </div>
          </div>    -->
          </div>
          <div class="col-md-5 form-group mb-3">
            <strong for="totalPrice" class="mb-3">پلن انتخابی</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{ invoiceDetail.totalPrice | currency }}"
              disabled
            />
          </div>
          <div class="col-md-8 form-group mb-3">
            <strong for="bankResponse" class="mb-3">پاسخ بانک</strong>
            <textarea
              class="form-control mt-1"
              id="bankResponse"
              rows="1"
              value="{{ invoiceDetail.bankResponse }}"
              disabled
            >
            </textarea>
          </div>
          <div class="col-md-4 form-group mb-3 align-self-md-end">
            <strong for="bankResponseDate"
              >زمان پاسخ بانک :{{
                invoiceDetail.createDate | relativeTime
              }}</strong
            >
          </div>
          <div class="col-md-3 form-group mb-3">
            <strong for="totalPrice" class="mb-3">قیمت محصول</strong>
            <input
              class="form-control mt-1"
              id="totalPrice"
              rows="1"
              value="{{ invoiceDetail.totalPrice | currency }}"
              disabled
            />
          </div>

          <div class="col-md-3 form-group mb-3">
            <strong for="discountPrice" class="mb-3">تخفیف</strong>
            <input
              class="form-control mt-1"
              id="discountPrice"
              rows="1"
              (change)="changeFinalPrice($event.target.value)"
              value="{{ invoiceDetail.discountPrice | currency }}"
            />
          </div>
          <div class="col-md-3 form-group mb-3">
            <strong for="toPayPrice" class="mb-3">پرداخت نهایی</strong>
            <input
              class="form-control mt-1 bg-success text-white"
              id="toPayPrice"
              rows="1"
              value="{{ invoiceDetail.toPayPrice | currency }}"
              min=" {{ invoiceDetail.totalPrice }}"
            />
          </div>
          <div class="col-md-3 form-group mb-3">
            <strong for="status" class="mb-3">وضعیت</strong>
            <input
              class="form-control mt-1 bg-success text-white"
              id="status"
              rows="1"
              value="{{ invoiceDetail.status | paymentStatus }}"
              disabled
            />
          </div>

          <div class="col-md-4 form-group mb-3">
            <strong for="status" class="mb-3">وضعیت پرداخت</strong>
            <select
              class="form-control mt-1 text-dark"
              id="status"
              placeholder="{{ invoiceDetail.status | paymentStatus }}"
              [formControl]="addForm.controls['status']"
              (ngModelChange)="selectStatus($event)"
              [ngModel]="invoiceDetail.status"
            >
              <option value="3">پرداخت شده</option>
              <option value="99">عدم پرداخت</option>
            </select>
          </div>

          <!-- <div class="col-md-3 form-group mb-3">
            <strong for="bankType" class="mb-3">نوع بانک</strong>
            <input
              class="form-control mt-1 bg-success text-white"
              id="bankType"
              rows="1"
              value="{{invoiceDetail.bankType|bankType}}"
              disabled
            />

          </div> -->
          <!-- <div class="col-md-3 form-group mb-3">
            <strong for="backMethodType" class="mb-3">قیمت نهایی برای پرداخت</strong>
            <input
              class="form-control mt-1 bg-success text-white"
              id="backMethodType"
              rows="1"
              value="{{invoiceDetail.backMethodType|bankMethod}}"
              disabled
            />

          </div> -->
          <!-- [ngClass]="{
            'bg-primary': invoiceDetail.status === 0 ,
            'bg-light text-dark': invoiceDetail.status === 1 ,
            'bg-info': invoiceDetail.status === 2 ,
            'bg-success': invoiceDetail.status === 3 ,
            'bg-info': invoiceDetail.status === 4 ,
            'bg-warning text-dark': invoiceDetail.status === 98 ,
            'bg-danger': invoiceDetail.status === 99 }" -->
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-outline-dark btn-rounded"
        (click)="modal.close(true)"
      >
        تائید
      </button>
    </div>
  </div>
</ng-template>
